<div class="tile is-3 is-vertical is-parent">
    <div class="tile is-child box">
        <p class="title">Filter</p>
        {% if 'uni' in filters.keys() %}
            <div>
                {{ "Universit채t" }}
                <br>
                {% for count in filters['uni'] %}
                    {% if count['value'].lower() in checked['uni'] %}
                        <label class="checkbox">
                            <input type="checkbox" id="{{ 'uni' }}" value="{{ count['value'] }}"
                                   onclick="handleClick(this);"
                                   hx-trigger="click" hx-get="/search" hx-target="#results"
                                   hx-vals='js:{query: get_query()}' checked>
                            {{ count['value'] }} ({{ count['count'] }})
                        </label>
                    {% else %}
                        <label class="checkbox">
                            <input type="checkbox" id="{{ 'uni' }}" value="{{ count['value'] }}"
                                   onclick="handleClick(this);"
                                   hx-trigger="click" hx-get="/search" hx-target="#results"
                                   hx-vals='js:{query: get_query()}'>
                            {{ count['value'] }} ({{ count['count'] }})
                        </label>
                    {% endif %}
                    <br>
                {% endfor %}
            </div>
            <br>
        {% endif %}
        {% if 'art' in filters.keys() %}
            <div>
                {{ "Art" }}
                <br>
                {% for count in filters['art'] %}
                    {% if count['value'].lower() in checked['art'] %}
                        <label class="checkbox">
                            <input type="checkbox" id="{{ 'art' }}" value="{{ count['value'] }}"
                                   onclick="handleClick(this);"
                                   hx-trigger="click" hx-get="/search" hx-target="#results"
                                   hx-vals='js:{query: get_query()}' checked>
                            {{ count['value'] }} ({{ count['count'] }})
                        </label>
                    {% else %}
                        <label class="checkbox">
                            <input type="checkbox" id="{{ 'art' }}" value="{{ count['value'] }}"
                                   onclick="handleClick(this);"
                                   hx-trigger="click" hx-get="/search" hx-target="#results"
                                   hx-vals='js:{query: get_query()}'>
                            {{ count['value'] }} ({{ count['count'] }})
                        </label>
                    {% endif %}
                    <br>
                {% endfor %}
            </div>
            <br>
        {% endif %}
        {% if 'faculty' in filters.keys() %}
            <div>
                {{ "Fakult채t" }}
                <br>
                {% for count in filters['faculty'] %}
                    {% if count['value'].lower() in checked['faculty'] %}
                        <label class="checkbox">
                            <input type="checkbox" id="{{ 'faculty' }}" value="{{ count['value'] }}"
                                   onclick="handleClick(this);"
                                   hx-trigger="click" hx-get="/search" hx-target="#results"
                                   hx-vals='js:{query: get_query()}' checked>
                            {{ count['value'] }} ({{ count['count'] }})
                        </label>
                    {% else %}
                        <label class="checkbox">
                            <input type="checkbox" id="{{ 'faculty' }}" value="{{ count['value'] }}"
                                   onclick="handleClick(this);"
                                   hx-trigger="click" hx-get="/search" hx-target="#results"
                                   hx-vals='js:{query: get_query()}'>
                            {{ count['value'] }} ({{ count['count'] }})
                        </label>
                    {% endif %}
                    <br>
                {% endfor %}
            </div>
            <br>
        {% endif %}
        {% if 'degree' in filters.keys() %}
            <div>
                {{ "Abschluss" }}
                <br>
                {% for count in filters['degree'] %}
                    {% if count['value'].lower() in checked['degree'] %}
                        <label class="checkbox">
                            <input type="checkbox" id="{{ 'degree' }}" value="{{ count['value'] }}"
                                   onclick="handleClick(this);"
                                   hx-trigger="click" hx-get="/search" hx-target="#results"
                                   hx-vals='js:{query: get_query()}' checked>
                            {{ count['value'] }} ({{ count['count'] }})
                        </label>
                    {% else %}
                        <label class="checkbox">
                            <input type="checkbox" id="{{ 'degree' }}" value="{{ count['value'] }}"
                                   onclick="handleClick(this);"
                                   hx-trigger="click" hx-get="/search" hx-target="#results"
                                   hx-vals='js:{query: get_query()}'>
                            {{ count['value'] }} ({{ count['count'] }})
                        </label>
                    {% endif %}
                    <br>
                {% endfor %}
            </div>
            <br>
        {% endif %}
        {% if 'course' in filters.keys() %}
            <div>
                <label>
                    <a style="color: inherit" title="nicht all Abk체rzungen gehen"> {{ "Fach " }}
                        <input class="input is-small"
                               id="course_input"
                               type="search"
                               onkeyup="searchHandler(this, 'course_list')"
                               onsearch="searchHandler(this, 'course_list')">
                    </a>
                </label>
                <br>
            <ul id="course_list">
                {% for count in filters['course'] %}
                    <li>
                    {% if count['value'].lower() in checked['course'] %}
                        <label class="checkbox">
                            <input type="checkbox" id="{{ 'course' }}" value="{{ count['value'] }}"
                                   onclick="handleClick(this);"
                                   hx-trigger="click" hx-get="/search" hx-target="#results"
                                   hx-vals='js:{query: get_query()}' checked>
                            {{ count['value'] }} ({{ count['count'] }})
                        </label>
                    {% else %}
                        <label class="checkbox">
                            <input type="checkbox" id="{{ 'course' }}" value="{{ count['value'] }}"
                                   onclick="handleClick(this);"
                                   hx-trigger="click" hx-get="/search" hx-target="#results"
                                   hx-vals='js:{query: get_query()}'>
                            {{ count['value'] }} ({{ count['count'] }})
                        </label>
                    {% endif %}
                    <br>
                    </li>
                {% endfor %}
            </ul>
            </div>
            <br>
        {% endif %}
        {% if 'professors' in filters.keys() %}
            <div>
                <label>
                    <a style="color: inherit" title="nicht all Abk체rzungen gehen"> {{ 'Professor*innen' }}
                        <input class="input is-small"
                               id="course_input"
                               type="search"
                               onkeyup="searchHandler(this, 'prof_list')"
                               onsearch="searchHandler(this, 'prof_list')">
                    </a>
                </label>
                <br>
            <ul id="prof_list">
                {% for count in filters['professors'] %}
                    <li>
                    {% if count['value'].lower() in checked['professors'] %}
                        <label class="checkbox">
                            <input type="checkbox" id="{{ 'professors' }}" value="{{ count['value'] }}"
                                   onclick="handleClick(this);"
                                   hx-trigger="click" hx-get="/search" hx-target="#results"
                                   hx-vals='js:{query: get_query()}' checked>
                            {{ count['value'] }} ({{ count['count'] }})
                        </label>
                    {% else %}
                        <label class="checkbox">
                            <input type="checkbox" id="{{ 'professors' }}" value="{{ count['value'] }}"
                                   onclick="handleClick(this);"
                                   hx-trigger="click" hx-get="/search" hx-target="#results"
                                   hx-vals='js:{query: get_query()}'>
                            {{ count['value'] }} ({{ count['count'] }})
                        </label>
                    {% endif %}
                    <br>
                    </li>
                {% endfor %}
            </ul>
            </div>
            <br>
        {% endif %}
        {% if 'document_type' in filters.keys() %}
            <div>
                {{ "Art des Documentes" }}
                <br>
                {% for count in filters['document_type'] %}
                    {% if count['value'].lower() in checked['document_type'] %}
                        <label class="checkbox">
                            <input type="checkbox" id="{{ 'document_type' }}" value="{{ count['value'] }}"
                                   onclick="handleClick(this);"
                                   hx-trigger="click" hx-get="/search" hx-target="#results"
                                   hx-vals='js:{query: get_query()}' checked>
                            {{ count['value'] }} ({{ count['count'] }})
                        </label>
                    {% else %}
                        <label class="checkbox">
                            <input type="checkbox" id="{{ 'document_type' }}" value="{{ count['value'] }}"
                                   onclick="handleClick(this);"
                                   hx-trigger="click" hx-get="/search" hx-target="#results"
                                   hx-vals='js:{query: get_query()}'>
                            {{ count['value'] }} ({{ count['count'] }})
                        </label>
                    {% endif %}
                    <br>
                {% endfor %}
            </div>
            <br>
        {% endif %}
        {% if 'filetype' in filters.keys() %}
            <div>
                {{ "Datei Type" }}
                <br>
                {% for count in filters['filetype'] %}
                    {% if count['value'].lower() in checked['filetype'] %}
                        <label class="checkbox">
                            <input type="checkbox" id="{{ 'filetype' }}" value="{{ count['value'] }}"
                                   onclick="handleClick(this);"
                                   hx-trigger="click" hx-get="/search" hx-target="#results"
                                   hx-vals='js:{query: get_query()}' checked>
                            {{ count['value'] }} ({{ count['count'] }})
                        </label>
                    {% else %}
                        <label class="checkbox">
                            <input type="checkbox" id="{{ 'filetype' }}" value="{{ count['value'] }}"
                                   onclick="handleClick(this);"
                                   hx-trigger="click" hx-get="/search" hx-target="#results"
                                   hx-vals='js:{query: get_query()}'>
                            {{ count['value'] }} ({{ count['count'] }})
                        </label>
                    {% endif %}
                    <br>
                {% endfor %}
            </div>
            <br>
        {% endif %}
    </div>
</div>
<div class="tile is-parent">
    <div class="tile is-child box">
        <section class="section">
            <div class="container">
                <nav class="panel">
                    <p class="panel-heading">
                        Suche
                    </p>
                    <div class="panel-block">
                        <p class="control has-icons-left">
                            <label for="search"></label><input id="search" class="input" type="text"
                                                               placeholder="Search"
                                                               hx-trigger="keyup changed delay:500ms" hx-get="/search"
                                                               hx-target="#results"
                                                               hx-vals='js:{query: get_query()}' value="{{ query }}">
                            <span class="icon is-left">
                  <i class="fas fa-search" aria-hidden="true"></i>
                </span>
                        </p>
                    </div>
                    <div>
                        <a class="panel-block">

                            <div class="column is-four-fifths">{{ results['found'] }} results found
                                in {{ results['search_time_ms'] }}ms
                            </div>
                            <div class="column">
                                <button class="button level-right" hx-trigger="click" hx-get="/generate"
                                        hx-vals='js:{query: get_query()}'
                                        hx-indicator=".htmx-indicator">Download All
                                </button>
                            </div>
                            <div class="column">
                                <span class="htmx-indicator">
                                    <img src="https://c.tenor.com/ql4f6dmta0UAAAAi/hamster-spinning.gif">
                                </span>
                            </div>

                        </a>
                        {% for value in results['hits'] %}
                            {% if loop.index == num_per_page-1 %}
                                <a class="panel-block"
                                   href="{{ request['client'].host }}/file/{{ value['document']['id'] }}"
                                   target="_blank" hx-get="/page/?page=2" hx-trigger="revealed" hx-swap="afterend"
                                   hx-vals='js:{query: get_query()}'>
                            {% else %}
                                <a class="panel-block"
                                   href="{{ request['client'].host }}/file/{{ value['document']['id'] }}"
                                   target="_blank">
                            {% endif %}
                        <div style="float:left;">
                            <ol style="list-style: none; font-size: 14px; line-height: 32px; font-weight: bold;">
                                <li style="clear: both;">{{ value['document']['uni'] }} {{ value['document']['faculty'] }}
                                    {{ value['document']['course'] }} {{ value['document']['semester'] }} {{ value['document']['year'] }}
                                </li>
                                <li style="clear: both;"> {{ value['document']['filename'] }}</li>
                                {% for professor in value['document']['professors'] %}
                                    <li style="clear: both;"> professor: {{ professor }}</li>
                                {% endfor %}
                                {% for highlight in value['highlights'] %}
                                    <li style="clear: both;"> field: {{ highlight['field'] }}</li>
                                    {% if 'snippets' in highlight.keys() %}
                                        {% for snippet in highlight['snippets'] %}
                                            <li style="clear: both;"> {{ snippet|safe }}</li>
                                        {% endfor %}
                                    {% else %}
                                        <li style="clear: both;"> {{ highlight['snippet']|safe }}</li>
                                    {% endif %}
                                {% endfor %}
                            </ol>
                        </div>
                        <div style="float:right">
                            <img src="{{ url_for('data', path=value['document']['directory'][6:]+"\\"+value['document']['filename'][:-3]+'png') }}"
                                 width="200" height="400" alt="nichts zu sehen">
                        </div>
                        </a>
                        {% endfor %}
                    </div>
                </nav>
            </div>
        </section>
    </div>
</div>
